# Итоговый проект (Модуль 2): Яндекс Афиша — анализ лояльности

# Анализ пользовательского поведения и повторных покупок сервиса продажи билетов

Проект посвящён анализу пользовательского поведения в сервисе продажи билетов с целью выявления факторов, влияющих на повторные покупки, частоту заказов и среднюю выручку.


## Файлы проекта
- `itog_project_m2.ipynb` — основной ноутбук проекта
- `requirements.txt` — зависимости
- `.env.example` — шаблон переменных окружения для подключения к PostgreSQL

## Установка зависимостей
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

## Цели проекта

- Провести предобработку и очистку транзакционных данных сервиса.
- Привести выручку к единой валюте (RUB) с использованием данных о курсах.
- Проанализировать поведение пользователей в разрезе количества заказов.
- Выявить ключевые факторы, связанные с повторными покупками.
- Оценить роль демографических и поведенческих признаков в удержании клиентов.

## Данные

В проекте используются:
- данные о покупках пользователей (заказы, выручка, количество билетов, сервис, регион, устройство);
- данные о курсе казахстанского тенге к рублю за 2024 год.

Основная единица анализа — заказ пользователя.

## Основные этапы анализа

1. Загрузка и первичная предобработка данных.
2. Проверка пропусков, типов данных и дубликатов.
3. Приведение выручки к рублям с учётом валюты заказа.
4. Анализ выбросов в выручке и количестве билетов.
5. Исключение неконсистентных транзакций с нулевой выручкой.
6. Формирование пользовательских агрегатов (количество заказов, интервалы между покупками, средний чек).
7. Сегментация пользователей по количеству заказов.
8. Анализ корреляционных связей внутри сегментов.


## Основные выводы

- Повторные покупки в большей степени объясняются поведенческими факторами, а не демографией пользователей.
- Ключевыми характеристиками являются:
  - частота покупок (интервалы между заказами);
  - количество билетов в заказе;
  - средняя выручка с заказа.
- Характеристики первого заказа (регион, сервис) оказывают слабое влияние на дальнейшую активность пользователей, особенно для клиентов с 2 и более заказами.
- Пользователи с одним заказом демонстрируют более вариативное поведение и широкий разброс средней выручки.
- Для пользователей с 2+ заказами поведение становится более стабильным, а повторные покупки связаны с регулярностью и объёмом заказов.
- В данных выявлены неконсистентные транзакции с ненулевым количеством билетов и нулевой выручкой; такие записи были исключены из анализа, так как они искажают метрики.

## Практическая интерпретация

Полученные результаты показывают, что стратегии удержания пользователей и роста LTV целесообразно строить вокруг стимулирования регулярных покупок и увеличения среднего объёма заказа, а не вокруг изменения каналов привлечения или "точки входа" пользователя.

## Технические детали

Проект выполнен в Python с использованием библиотек:
- pandas
- numpy
- matplotlib
- seaborn
- sqlalchemy

Параметры подключения к базе данных вынесены в переменные окружения и не хранятся в репозитории.

